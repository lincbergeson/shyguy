<!DOCTYPE html>
<html>
<head>
<style>
html, body {
	margin: 0;
  width: 100%;
	height: 100%;
}
#mainCanvas {
  width:100%;
  height:100%;
  position:absolute;
}
</style>
<body>

<canvas id="mainCanvas">
Your browser does not support the HTML5 canvas tag.
</canvas>

<script>

// initialize main shyguy container
var shyguy = {
  intervals: {},
  input: {},
  draw: {},
  game: {},
};

// set up the main canvas FIRST
shyguy.canvas = document.getElementById("mainCanvas");
shyguy.ctx = shyguy.canvas.getContext("2d");

shyguy.canvas.resize = function() {
  shyguy.canvas.width = window.innerWidth;
  shyguy.canvas.height = window.innerHeight;
  shyguy.draw.main();
}
window.addEventListener('resize', shyguy.canvas.resize, false);

// player object holds everything related to our protagonist
shyguy.player = {
  x: 200,
  y: 200
}
shyguy.player.moveRight = function () {
  shyguy.player.x += 10;
}
shyguy.player.moveLeft = function () {
  shyguy.player.x -= 10;
}
shyguy.player.moveUp = function () {
  shyguy.player.y -= 10;
}
shyguy.player.moveDown = function () {
  shyguy.player.y += 10;
}

// setup keyboard input framework
shyguy.input.processKeyDown = function (event) {
  switch(event.code) {
    case "Escape":
      shyguy.intervals.toggle();
      break;
    case "ArrowUp":
    case "ArrowDown":
    case "ArrowRight":
    case "ArrowLeft":
      shyguy.input.keydown = event.code;
      break;
  }
}
window.addEventListener('keydown', shyguy.input.processKeyDown, false);
shyguy.input.processKeyUp = function (event) {
  switch (event.code) {
    case "ArrowUp":
    case "ArrowDown":
    case "ArrowRight":
    case "ArrowLeft":
      shyguy.input.keydown = "";
      break;
  }
}
window.addEventListener('keyup', shyguy.input.processKeyUp, false);

// the first of the two main asynchronous loops: render the game screen
shyguy.draw.main = function() {
  shyguy.ctx.clearRect(0, 0, shyguy.canvas.width, shyguy.canvas.height);
  shyguy.ctx.beginPath();
  shyguy.ctx.arc(shyguy.player.x, shyguy.player.y, 40, 0, 2 * Math.PI);
  shyguy.ctx.stroke();
}

// the second of the two main asynchronous loops: execute game logic
shyguy.game.main = function() {
  shyguy.game.pollInput();
}
shyguy.game.pollInput = function() {
  switch (shyguy.input.keydown) {
    case "ArrowUp": shyguy.player.moveUp(); break;
    case "ArrowDown": shyguy.player.moveDown(); break;
    case "ArrowLeft": shyguy.player.moveLeft(); break;
    case "ArrowRight": shyguy.player.moveRight(); break;
  }
}

// start the two main loops
shyguy.intervals.stopped = false;
shyguy.intervals.toggle = function () {
  if (shyguy.intervals.stopped) shyguy.intervals.start();
  else shyguy.intervals.stop();
  shyguy.intervals.stopped = !shyguy.intervals.stopped;
}
shyguy.intervals.start = function() {
  shyguy.intervals.draw = window.setInterval(shyguy.game.main, 50);
  shyguy.intervals.game = window.setInterval(shyguy.draw.main, 50);
}
shyguy.intervals.stop = function() {
  window.clearInterval(shyguy.intervals.game);
  window.clearInterval(shyguy.intervals.draw);
}

shyguy.canvas.resize();
shyguy.intervals.start();


</script>

</body>
</html>